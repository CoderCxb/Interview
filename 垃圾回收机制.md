### 1. 垃圾回收机制

- 什么是垃圾回收机制?

  垃圾回收是一种自动的内存管理机制，当程序中的内存不再使用时，应该予以释放。JavaScript的垃圾回收机制是自动的，C和C++是手动的，并且并不是马上执行，而是在CPU空闲时执行，尽可能减少对程序的影响(Node可以手动触发)。

- 为什么要有垃圾回收机制？

  JS程序创建的所有变量、函数等等都会占用内存，如果这些内存不进行释放则无法重新使用，那么当内存占满之后，程序就会崩溃，因此垃圾回收机制是必要的。

- 内存泄露(Memory Leak)

  程序中已分配的内存由于某种原因未能释放，造成系统内存的浪费，导致程序运行速度减慢甚至崩溃。



### 2. 常用方式

1. 标记清除（常用）

   ![img](images\10.gif)

   当变量进入执行环境后，将变量标记为"进入环境"，当变量离开环境后，将其标记为"离开环境"，逻辑上讲，永远不能释放进入环境的变量的内存(可能会用到)。

2. 引用计数

   ![img](images\11.png)

   

   记录每个值被引用的次数，当一个值被引用的时候，这个值的引用次数就会+1，当值的引用次数为0的时候，则无法再访问到这个值了，因此可以回收其内存空间。



### 3. 常见的垃圾泄露情况

1. 全局变量

   将变量挂载到window上，那么在程序关闭前，内存都无法回收

2. 计时器和回调函数

3. 闭包